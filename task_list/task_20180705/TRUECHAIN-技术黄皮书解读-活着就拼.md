




										《对于技术黄皮书解读》

　　
　　一、解读技术黄皮书：

		从黄皮书中，可以看到'初链协商一致协议'这个细节问题。简而言之，就是和'混合共识机制'具有相同特性的一种协议，
	就是各位的共识设计具有同样的一致性、活跃度、交易终结性和安全保障。
	
		初链为什么会采用'混合共识机制'，这原因就是为了弥补前两代公链比特币与以太坊每秒交易处理量(TPS)过低导致
	无法应用到实质商业应用开发的弊病。在保证去中心化本质的基础上,实现高性能、高可靠性的公链开发,以承载规模化商
	用Dapp运行的目标。
	
	其实解读初链技术可以从以下几个方面出发，来详细来分析：
		1、混合委员会选举（节点选取）的问题。
		2. 物理时间限制（时间戳与时间限制）：
		3. 计算与数据片区,及推断交易执行
		4. 虚拟机与智能合约
		5. 补偿与奖励机制：
		6. 初链未来方向
	
		
	详细解读：
		1、混合委员会选举（节点选取）的问题。
				BFT委员会的实例每隔一段固定时间(以Snailchain作为逻辑时钟)进行切换，但是这个切换规则还是存
			在问题的。
		　　	现在BFT社区节点选取多采用固定时间段更换一次,更换为新挖矿的其他节点。但是问题来了，如果之前
			的节点社区表现优异,为什么要强制撤换呢?而如果只因这些节点表现优异就不撤换的话,新节点就难以加入社
			区。这就是'节点选取问题'的尴尬之处。所以给出了解决方法：
			
				只要在其间进行取舍就行,即每隔一段时间更换一次节点,但是这还会出现潜在的造假或出错情况。一旦
			这种情况发生,次日即可进行强制更换节点,而不必等到固定时点。更为关键的是选举机制的设定。一般混合
			机制是从最近挖矿的矿工节点中选取,但初链采用的是权益证明和随机选取相结合的方式。具体地说,全节点
			可以临时性冻结它们的代币资产,一定比例的超级节点将分配给全节点中权益证明较高的一些节点;另外部分
			的节点按照VRF随机过程选取,随机过程的种子由上一次选举的种子和节点社区容量决定。不同于Algorand,
			初链在此阶段将不会计算权益比例。随机过程选取的节点可以假定是完全不认识的,因此不可信。对于此种
			潜在情况,初链的策略是估算不可靠节点的比例,让该比例的不可靠节点不会
			影响正常决策。诚然,掌握巨大运算资源的一方可能，操纵VRF随机过程,但这已不在此讨论范围内。



		2. 物理时间限制（时间戳与时间限制）：
				初链在默认情况下，传统的共识设计允许成员在一个小的时间窗口内重新安排交易。但是正是由于自
			由交易不受控制，这就带来了问题：
		　　	因为最终的一致性、活性与安全性是万万不能被割舍的。传统共识机制默认地给予了矿工、节点社区
			成员和领导者一定的时间窗口,导致在要求严格时间顺序的商业互换等智能合约中,可能存在恶意节点调换
			合约顺序、插入自身合约等不正当牟利手段。当吞吐量较高时,这种不当激励将被继续放大。
		　　更糟糕的是,这种恶意调换由于存在天然网络延迟导致顺序调换的可能而难以被察觉,除非这种调换被接受
			者自己所发现并掌握最终延迟的证据。为支持这种去中心化的商业互换,初链引入了粘性时间戳作为额外
			限制。这个时间戳是一个启发式的参数,会随时间进程而改变。当一笔交易等待验证
			时,用户把自己的物理时间戳作为交易元数据与交易打包上传。BFT链的验证器会随后根据以下算法检验该
			笔交易是否有效地被记录过或有意忽视过。如果出现被忽视、误记或延迟记录,则报告问题,即说明之前节
			点的记录是有问题的。
			
			　　(1)检验验证器当前时间与物理时间戳的差值是否小于粘性时间戳。如果大于,则说明该笔交易上传到验
			证器的时间与其真实发
			出的时间相差过大,可以判定之前节点出现了忽视、延误或有意偏向等问题。
			　　(2)检验交易是否被记录过。如果被记录过,则继续检验当前链的最后一笔交易的时间戳是否早于新上传
			的交易。如果出现链上
			最后一笔交易的时间戳晚于新上传交易,可以判定之前节点的记录出现了错误、延误或造假的可能。
			　　(3)如果未被记录过或时间戳未出现顺序颠倒,则把这笔新的记录添加到账本中。

　　

		3. 计算与数据片区,及推断交易执行
				计算和数据分片，这其实就是对原始混合共识的一个重要提升。
		　　	日常BFT节点索引自一个确定的日常BFT节点序列,允许同一时间选取多重序列。除去子片,另外存
			在一个包含等同于社区节点数目那么多节点的主片。
			它负责对子片的输出进行排序并作为分布式交易处理系统的协调员。子片向主片上传log,由主片与混
			合共识进行沟通而非直接与其沟通。社区选举的流程将强行规定,任何片区不能共享同一节点。片区的
			选举类似于上述混合共识选举过程。数据被均匀分布在各子片中,保证每一次调用对应片区都会返回一
			致的值。每一个数据单元都包含元数据。数据将被拆分成数据单元,然后每个数据单元将被分配到一个
			地址。地址与数据位置建立映射。可以假设这种分区规则是公开的,通过执行host函数可以得到一个地
			址的所在片区。如果每个普通节点都被视为分布式处理单元,逻辑时间戳的设计就可以被包含在分布式
			交易处理系统之中,对交易处理进行授权。这里将运用MaaT的简化版本,并不会对其他交易的时间戳进行
			自动调整。
		　　	对于主片,它负责收集全部普通节点的输出。值得注意的是,交易的数据依赖性可以从元数据轻松地
			被推断出来。如果一个交易访问了多个远程片区,它将会在所有涉及的片区留下痕迹。当一个子片向主片
			提交log时,它也会在慢链上留下记录。
			　　当基础节点从一个片区收到了一批交易,它将会检查它是否收到了来自所有片区的该批次交易。如
			果在一定时间内它没有收到固定的一批交易,就意味着这一批次是失败的。这种情况下,就需要在第二天
			的开始时更换整个社区。在接受到所有片区的log后,主片将会根据时间戳整理交易顺序。(拥有最早批次
			编号的交易会被认为是一笔交易,但如果物理时间戳与许多其他片区的时间戳相悖,则认为该批次无效并丢
			弃该批次包含的所有交易)。在整理之后,主片会筛选所有的交易并根据物理时间戳选择
			最长的非减编号序列。对混合共识机制公布后形成当天的log。当然该设计还有很多改进空间。一个
			比较重要的确定就是这种机制的确认时点不是立刻。

　　

		4. 虚拟机与智能合约
　　			在此部分我们主要解决两个问题:

	　　(1)为什么要使用虚拟机,而不是容器?
				初链团队先前做出了一个重大猜想，为什么'为什么要使用虚拟机,而不是容器呢？'，
		　　	其实一种区块链架构来自超级账本,但超级账本是针对私有链及联盟链开发的。如果希望将其架构
			应用到公链上,则需要解决链码的问题。尽管一个链码可以部署在一个容器中,但这对于公链来说显然
			是无法规模化的。一个同时运行几千个智能合约的公链意味着需要几千个容器,但数千个容器显然是不
			现实的,所以只能选择限制同时运行的智能合约数量。社会上有很多容器数量的尝试,但即使运用常用的
			存储技术,容器容量也仅能达到1000,远远达不到要求。而且人们宁愿水平扩大容器规模也不愿意垂直扩
			大容器容量,因为后者极大程度上提升了设计的复杂度。也没有一个适应全部集群规模结构的规则,因为
			它完全取决于负载量,而且在去中心化时更是如此。
				对于现在部署有1000多个智能合约的以太坊,它除了是一次在最优化容器生态设计上粗浅的尝试
			之外一无是处。也有可能解决的方法,比如把容器运用到无服务器结构中。但想象一个多于2000个智能
			合约在线和并发请求的场景,比如想链码发送超过容器数量的调用请求,我们仍会面临同样的困境。途径
			就是给并发请求加上节流限制,但这将严重影响TPS。工程问题不应当成为我们达成目标的平静,因此初
			链仍然采用了以太坊虚拟机的设计。
			
	　　(2)初链虚拟机(TVM)
		　　	在这一领域的范例是以太坊虚拟机(EVM)。它尝试跟随决定主义,在简化激励计算步骤上做出了
		优化。它还支持内存的非堆栈存储、合约授权以及调用间的价值存储。而初链将继续将EVM应用于慢链之
		上,并在PBFT主干节点中应用TVM,以使得每个全节点能够响应不同调用请求。但TVM的构想还并不是很成
		熟,需要确定TVM的过渡状态、智能合约部署策略及从私链虚拟机向公链虚拟机的转变。同时还要确定从
		POW节点向PBFT节点转变的参数。



		5. 补偿与奖励机制：
				首先什么是'补偿机制'？顾名思义，其实就是：
			以平衡BFT委员会成员和非成员完整节点的工作量，根据网络带宽、CPU为标准对所有片区一视同仁
			将导致倾斜性结果，如不一致的TPS，或者更严重的是有时超过了超时限制，因为交易的顺序是由
			主片决定的。为了处理这个问题，我们建议的奖励基础设施，与网络计算领域的伯克利开放网络一
			起工作。前面在这领域做过类似尝试的是Gridcoin和Golem网络。
		　　	对于BFT社区节点与非社区全节点的工作量的奖励是奖励机制的核心问题。如果根据网络和CPU
			带宽而为所有片区都提供相同奖励,则会产生严重的偏向性结果,比如不一致的TPS或更严重的如在子
			片整理交易顺序时发生交叉超时限制。为解决该问题,初链可能会采用服务于网络计算的伯克利公
			链(BOINC)上的激励机制。Gridcoin和Golem在该领域上有过早期尝试,但其未能解决其早期用户
			面临的财富分配不一致性。初链的混合共识机制运用公平的、随机抽取的、轮换的社区制度天然地
			避免了持币者拥有持续性地获得大量奖励,从而保证了财富的公平分配。为补偿计算算力的不均匀性
			,初链设置了从BFT与POW池获得奖励的奖励机制。在工程设计上,利用标识改变工作分配,让BFT交易、
			POW、激励池依次获得资源分配的优先级。通过这种方式,如果BFT节点由于K天数限制(最多每
			K天必须更换一次节点)被清出网络,它仍可以通过为网络其余部分提供补偿机制享受到投资硬件产
			生的收益。所有的节点都能完成POW和PBFT的任务,但是PBFT获得更高的优先级。

	　　

		6. 初链未来技术攻关方向

		　　(1)在不依靠中心化的NTP服务器的情况下,提高所有节点时间戳的同步性;
		　　(2)解决激励机制;
		　　(3)用创建副本的分片技术减少来自BFT社区的事务集拒绝次数;
		　　(4)增加零知识证明对隐私的保护;
		　　(5)建构EVM、TVM与Linux容器生态的混合基础设施;
		　　(6)构想虚拟机规范、二元数据加密方法、交易签名、费用计划和Ethash算法替代品。
　　
　　二、总结
			展望未来，初链已是雄鹰，已经彻底遨游于科技的太空之中。混合共识亦是众望所归。初链是混合共
		识领域的先行者。但是混合共识机制目前还不是非常完备，这还需要初链开发人员以及我们大家共同努力，
		打造一个完美的混合共识体，一个完美的初链体系。为以后的生活提供更高的美好。
			在这里祝愿初链逐渐深入到各行各业，混合共识机制深入人心。
