# 初链黄皮书解读

## 初链的介绍

  初链是基于以太坊开发创新的一条公链，最大的技术突破是使用了混合共识机制，目前世界算的上第一家。其特点在于将pbft和pow共识结合在一起。pbft的通讯效率足以支持10000-100000的TPS能力，而pow又是公认的去中心的共识算法。这两者的完美融合，能够在尽可能保证去中心化，同时又兼顾到性能提升。

  也许有人会提出疑问，pbft适用条件苛刻，要求节点之间相互信任，大都应用在联盟链上，把它应用在公链上，是不是不太可行啊？

  初链创始人张剑南以及他的团队打破传统思维，通过pow共识算法以及其他成型或者正在研究的策略，提供给pbft共识机制一个的良好运行环境，最大可能保障委员会成员不受外围控制或者攻击。同时将“水果链”(Fruitchain)技术整合到原来混合共识底层的PoW技术,由原来的PoW变成了fPoW，目的是让每个节点都能参与到挖矿中去，实现公平公正的挖矿思想。
  
## 初链的核心理念及发展方向

  打造理想自由互信社会的区块链4.0时代。
  成为高性能行业应用设计的共有链，为各行业的应用提供高效的合约发布，监控和全生命周期管理工具，拥有去中心化的社区共建组织架构。主要服务广告，版权，人力资源，AI，游戏等行业。

## 初链核心技术

  公链的核心技术就是交易。所以检验是不是一条好的公链，我们首先研究它的交易过程，接下来，我就简单介绍下初链交易是如何完成的，以及它的优势是什么？
  
### 新颖概念

  首先引入一些概念：拜占庭委员会，交易集，水果，水果链。
1. 拜占庭委员会：
  成员目前定的是31个节点。主要是对交易信息的确认，达成共识后，将该交易放到交易集里。
  委员会的选举过程：pow最新挖矿成功的节点->当届委员会对该节点进行确认->进入委员会候选队列->换届时间到，触发换届机制，选出委员->新旧委员会换任
  初始化的委员会成员是指定的。但之后都是通过每个节点参与竞选和随机函数VRF选中的。每届委员会都有任期，这个任期时间通常是个大约数（就像比特币每大约10分钟出块一个一样），这个大约数在黄皮书里没有给定。我的思路是委员会候选队列节点数量达到指定值，就进入选举委员阶段，完成后进行换届。从上一届委员会上任到此时换届的持续时间就是换届时间。
  挖矿成功在下边有提到：就是成功挖到果实或者区块。
  每个挖矿成功的矿工节点都会成为委员会候选人。当一个诚实的BFT节点的链长度达到λ，它会发布链中每个果实链的唯一矿工ID作为候选人（或者每个挖掘超过ν的果实链的矿工ID）。 新的BFT委员会是通过应用VRF从候选人中随机选出。
2. 交易集：
  通过pbft共识后的交易请求，暂时存在交易集里，也可以理解成一个数组里面。
3. 水果/水果链：
   传统的pow挖矿，有个很大的bug，就是算力越强的节点越容易获得pow挖矿机会，这样造成普通的节点很难有机会挖到矿。总是出现这些问题：联合挖矿(矿池)；自私挖矿者攻击(Selfish Mining Attack - 即25%攻击)；不稳定交易费。为克服这个问题，初链引入了水果链技术。
   水果就是类似区块的一个包，需要矿工去挖掘，而且很容易挖到，大约1天能挖到2个。水果被挖到后，会将交易数据放到水果里，在区块被挖到之前，这些水果会形成一个数据链，也就是水果链。区块被挖出后，这些带有交易数据的水果包会被放置在区块里。区块进入拜占庭委员会进行确认，如果达成共识就将该区块放到区块链上。
   
### 初链fPOW共识算法的特点  
 
   结合目前市场上已有算力的情况,TrueChain设计并改进了PoW,名称是fPOW，将其作为TrueChain底层SnailChain的协议。根据TrueChain的黄皮书,在fPoW挖矿的过程中,将有以下特点:

1）能抵制联合挖矿

水果(Fruits)比区块(Blocks)挖矿难度低, 普通挖矿,个人平均两年才能挖到一个矿,但水果却一天可以挖到两个,这样矿工形成的矿池的动力就变小了,从而抵制了联合挖矿,使得PoW更加公平。

2）能抵制自私挖矿

水果在被写入区块前都不稳定,而且存在一定的保质期,算法规定包含最多水果的块为主链,所以矿工挖矿需要尽快将水果收到区块里,而不能默不作声地等着浪费别人的算力,从而抵制了自私挖矿; 而矿工将水果收入会先得到挖矿奖励,再将一定奖励分发给包涵进区块的水果。

3）乱序挖矿

fPoW协议使得水果的挖矿顺序可以为任意顺序,即可以并行挖矿,在Sharding中非常有用。

综上可以看出,fPoW确实可以有效地解决PoW去中心的隐患,从而确保了去中心化,带来了公平性和安全性。fPoW将为TrueChain混合共识协议提供更好的SnailChain基础设施!

### 交易

  了解了初链的技术特点，我们分析一下交易是如何实现的。
  交易验证的简单流程如下：
    交易请求->pbft->交易集->水果->区块->区块链
  1.首先客户端发送一个交易请求给拜占庭委员会主节点
  2.主节点接收到请求，并广播给其他委员会成员节点。按照pbft共识，对该请求进行确认
  3.pbft达成共识后，将交易请求放到交易集里
  4.pow节点进行挖矿，挖出水果或者区块。挖到水果，就将交易集放到水果里，形成水果包。挖到区块就把多个水果包放进区块里。
  5.区块连到链上形成区块链。 

### 物理时间限制和分片技术
  
  为保障交易的安全有序的进行，初链使用了物理时间限制和分片技术。
  传统的共识设计允许矿工/委员会成员/领导人在一个小的时间窗口内重新安排交易。这样一些利益企图者，就会通过交易插队，来获得额外利润。
  通过物理时间限制技术，要求客户端在提交交易时，把物理时间戳放在交易处理的源数据中，并对时间戳和交易数据进行签名。拜占庭委员会接收到交易请求后，领导者将根据其物理时间对事务批次进行排序。这样交易的次序就不会发生变化。
  分片技术，初链设计了一个基于分片的投机交易处理系统，保障数据在处理过程中不会受到其他方面的影响，确保了数据的安全性。初链允许同时存在多个DailyBFT实例序列进程，为了让这些进程互不干预独立稳定地运行，将这些进程分别给予一块独立的运行空间，也就是分片。有一个由csize节点组成的主分片确定正常分片输出的顺序，以及在分布式事务处理系统中实现协调器。这样每个DailyBFT实例序列进程能够有序安全地运行。

## 技术总结
  
  初链的公链技术还有很多，我只是把它最标志性的技术阐述了下。其他的技术，也不是拿来主义的应用，而是根据市场的需求和自己严格的要求，不断在实践和改进，目的就是让这条链越来越健壮，成为大家都认可的一条公链。
       
## 初链的持续研究方向
  
  . 改进所有节点的时间戳同步，而不需要中心化的NTP服务器。
  . 喜欢奖励基础设施里的激励技术，这样重度投资基础设施的投资人不会遭遇“被忽视”，“亏本”的问题。
  . 支持副本创建的分片技术，尽量减少被BFT会员会拒绝的交易集。
  . 添加零知识证明以增强隐私。
  . EVM、TVM和Linux容器技术的混合基础设施。
  . 改进虚拟机规范中的二进制数据编码方法，交易签名，收费表等章节
  
## 初链的未来
 
 通过研读初链的黄皮书，让我受益匪浅。让我对区块链有了新的认知。也对初链有了更加深入的了解。我认为它才是一条真正意义上的去中心化的良心公链。这条链应该是属于全世界的。但目前初链的影响力便重于国内，国外对它熟悉度不高。希望初链团队秉着对世界负责的态度，向全世界发出公告，让世界的各个角落里都能听到初链的声音。
 今天的区块链看以太坊，未来的区块链看初链。



