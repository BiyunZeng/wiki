# 加密技术

在如今的现代加密技术中常见的加密算法可以分成三类，对称加密算法，非对称加密算法和Hash算法

#Hash算法：
它的特别的地方在于它是一种单向算法，可以通过Hash算法对非常大的目标信息生成一段特定长度的唯一的Hash值，却不能通过这个Hash值重新获得目标信息。因此Hash算法常用在不可还原的密码存储、信息完整性校验等。常见的Hash算法：MD2、MD4、MD5、SHA、SHA-1、SHA-256

#对称加密：
指加密和解密使用相同密钥的加密算法，优点在于加解密的高速度和使用长密钥时的难破解性，对称加密算法的安全性取决于加密密钥的保存情况。比如电视中的谍战片，发报机发出信号，抄报员写下对应的数组，然后根据密码本，可能是一本三国演义，也可能是中华字典，找出对应的字连成信息。密码本就是密钥，因此加密和解密都必须要相同的密码本。不然就会出错。因此常常在电视剧里能看到xxx携带密码本来上海，开启新的密码。常见的对称加密算法：DES、3DES、AES、DESX、Blowfish、IDEA、RC4、RC5、RC6

# 公钥密码-非对称加密

公钥密码又称为非对称密码，拥有公钥密码的用户分别拥有加密密钥（公钥）和解密密钥（私钥）。通过加密密钥不能得到解密密钥。并且加密密钥（公钥）是公开的。


## 什么是密钥配送问题

在现实世界中使用对称密码时，我们一定会遇到密钥配送问题。

假如 A 给 B 写了一封情书，并使用对称加密，如果不讲加密密钥发送给B，B是无法查看情书的，如果将密钥和情书一起发送给B，就容易被攻击者截获。

**密钥必须要发送，但又不能发送**，这就是对称密码的密钥配送问题。

解决密钥配送问题的方法：

* 通过事先共享密钥来解决
* 通过密钥分配中心来解决
* 通过公钥密码来解决（非对称加密）

### 通过事先共享密钥来解决

密钥配送问题最简单的一种解决方法，就是事先用安全的方式将密钥交给对方，这称为密钥的事先共享。 事先共享的局限性:

* 需要一种安全的方式将密钥交给对方。
* 即便能够实现事先共享密钥，但在人数很多的情况下，通信所需要的密钥数量也会增大。

### 通过密钥分配中心来解决

如果所有参与加密通信的人都需要事先共享密钥，则密钥的数量会变得巨大，这样额情况下就可以使用密钥分配中心来解决密钥配送问题。当需要进行加密通信时，密钥分配中心会生成一个通信密钥，每个人只要和密钥分配中心事先共享密钥就可以了。有多少个人进行通信分配中心就保存了多少密钥。

局限性：

* 随着通信人数的增加，密钥分配中心的负荷也会随之增加。如果密钥分配中心计算机发生故障，所有的加密通信就会瘫痪。

* 如果主动攻击者入侵了密钥分配中心计算机，并盗取了密钥数据库，所有人的加密通信都会被破译。

### 通过公钥密码来解决 

## 什么是公钥密码

公钥密码，又称为非对称密码，密钥分为加密密钥和解密密钥两种。发送者用加密密钥对消息进行加密，接收者用解密密钥对密文进行解密。

加密密钥和解密密钥的区别：

* 发送者只需要加密密钥
* 接收者只需要解密密钥
* 解密密钥不可以被窃听者获取
* 加密密钥被窃听者获取也没问题

解密密钥从一开始就是由接收者自己保管的，因此只要将加密密钥发给发送者就可以解决**密钥配送问题**了，而根本不需要配送解密密钥。

## 公钥通信的流程

我们还是假设Alice要给Bob发送一条消息，Alice是发送者，Bob 是接收者，而这次窃听者Eve依然能够窃听到他们之间
的通信内容。

在公钥密码通信中，通信过程是由接收者Bob来启动的。

1. Bob生成一个包含公钥和私钥的密钥对。私钥由Bob自行妥善保管。

2. Bob 将自己的公钥发送给Alice。
    
    Bob的公钥被窃听者Eve截获也没关系。
    将公钥发送给Alice,表示Bob请Alice用这个公钥对消息进行加密并发送给他。

3. Alice用Bob的公钥对消息进行加密。
    
    加密后的消息只有用Bob的私钥才能够解密。虽然Alice拥有Bob 的公钥，但用Bob的公钥是无法对密文进行解密的。

4. Alice将密文发送给Bob。

    密文被窃听者Eve截获也没关系。Eve可能拥有Bob的公钥，但是用Bob的公钥是无法进行解密的。

5. Bob用自己的私钥对密文进行解密

公钥通信的流程图：

![](http://olgjbx93m.bkt.clouddn.com/20180117-065945.png)

常用的非对称加密算法有RSA、ECC椭圆曲线加密、DSA（数字签名用）

现在我们看看非对称加密在比特币中的应用：

![微信截图_20180710011429.png](https://upload-images.jianshu.io/upload_images/4207935-de12765b73e6e029.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

1、首先由发送方发送消息hello给接收方，发送方用接收方的公钥进行加密，产生密文

2、发送方将要发送的消息进行hash，然后使用发送方的私钥对hash的值进行签名

3、然后将签名后的结果和密文一起通过网络送达接收方，接收方通过接收方的私钥对密文解密得到hello

4、接收方通过使用发送方的公钥把签名的结果解签名，得到一个信息摘要

5、接收方将解密出来的内容hash，然后在对比解签得到的摘要，若一致则成功，不一致则失败。说明有篡改。

此流程就为非对称加密在比特币中的运用，公钥负责加密和解签名，私钥负责解密和签名。然后比特币地址也是由公钥经过sha256hash，再经过ripemd160 hash的结果加上版本和2次这个结果的sha256 hash取前或者后4个字节最后经过Base58Encode编码而成我们大家看到的比特币的地址。


